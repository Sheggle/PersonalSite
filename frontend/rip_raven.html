<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>RipRaven - Comic Reader | sheggle</title>
    <link rel="stylesheet" href="/styles.css" />
    <style>
      /* Custom styles for iframe page */
      .iframe-container {
        width: 100%;
        height: calc(100vh - 8rem);
        border: 1px solid #30363d;
        border-radius: 8px;
        overflow: hidden;
        background: #0d1117;
        position: relative;
        display: flex;
        align-items: center;
        justify-content: center;
      }
      .ripraven-iframe {
        width: 100%;
        height: 100%;
        border: none;
        background: white;
        z-index: 1;
      }
      .iframe-loading {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        color: #7d8590;
        font-size: 0.9rem;
        z-index: 0;
      }
      .header-row {
        display: flex;
        align-items: center;
        justify-content: space-between;
        margin-bottom: 1rem;
        gap: 1rem;
        flex-wrap: wrap;
      }
      .nav-back a {
        background: #21262d;
        padding: 0.5rem 1rem;
        border-radius: 6px;
        border: 1px solid #30363d;
        text-decoration: none;
        font-size: 0.9rem;
        white-space: nowrap;
      }
      .nav-back a:hover {
        background: #30363d;
        text-decoration: none;
      }
      .page-title {
        font-size: 2.7rem;
        margin: 0;
        color: #e6edf3;
        font-weight: normal;
      }
      .tips-section {
        margin-top: 1rem;
        font-size: 0.9rem;
        color: #7d8590;
      }
      .tips-section ul {
        margin: 0.5rem 0;
        padding-left: 1.5rem;
      }

      /* Mobile Responsive Styles */
      @media (max-width: 768px) {
        /* Reduce main container margin on mobile */
        .wrap {
          margin: 1rem auto !important;
          padding: 0 0.75rem !important;
        }

        /* Stack header elements vertically on small screens */
        .header-row {
          flex-direction: column;
          align-items: stretch;
          gap: 0.75rem;
          margin-bottom: 0.75rem;
        }

        /* Scale down title for mobile */
        .page-title {
          font-size: 1.8rem;
          text-align: center;
          order: -1; /* Put title first on mobile */
        }

        /* Make back button full width on mobile */
        .nav-back {
          order: 1;
        }
        .nav-back a {
          display: block;
          text-align: center;
          padding: 0.75rem 1rem;
          font-size: 1rem;
        }

        /* Adjust iframe container for mobile browsers */
        .iframe-container {
          height: calc(100vh - 12rem);
          border-radius: 6px;
          min-height: 400px; /* Ensure minimum usable height */
        }

        /* Optimize tips section for mobile */
        .tips-section {
          font-size: 0.85rem;
          margin-top: 0.75rem;
        }
        .tips-section ul {
          padding-left: 1.25rem;
        }
        .tips-section li {
          margin-bottom: 0.25rem;
        }

        /* Mobile-specific iframe optimizations */
        .ripraven-iframe {
          -webkit-overflow-scrolling: touch; /* iOS smooth scrolling */
        }

        /* Improve touch interactions on mobile */
        .nav-back a {
          -webkit-tap-highlight-color: rgba(255, 255, 255, 0.1);
        }
      }

      @media (max-width: 480px) {
        /* Extra small screens */
        .wrap {
          margin: 0.5rem auto !important;
          padding: 0 0.5rem !important;
        }

        .page-title {
          font-size: 1.5rem;
        }

        .nav-back a {
          font-size: 0.9rem;
          padding: 0.6rem 0.8rem;
        }

        /* Even more compact iframe on very small screens */
        .iframe-container {
          height: calc(100vh - 14rem);
          border-radius: 4px;
          min-height: 350px; /* Ensure minimum usable height */
        }

        .tips-section {
          font-size: 0.8rem;
        }
      }

      @media (max-width: 320px) {
        /* Very small screens like older phones */
        .page-title {
          font-size: 1.3rem;
        }

        .iframe-container {
          height: calc(100vh - 16rem);
          min-height: 300px; /* Ensure minimum usable height */
        }
      }
    </style>
  </head>
  <body>
    <main class="wrap" style="max-width: 100%; margin: 2rem auto;">
      <div class="header-row">
        <div class="nav-back">
          <a href="/">‚Üê Back to Home</a>
        </div>
        <div class="page-title">üìö RipRaven Comic Reader</div>
      </div>

      <div class="iframe-container">
        <div class="iframe-loading" id="iframeLoading">
          üìö Loading RipRaven Comic Reader...
        </div>
        <iframe
          src="/api/ripraven/"
          class="ripraven-iframe"
          id="ripravenIframe"
          title="RipRaven Comic Reader"
          allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
          allowfullscreen
          loading="lazy"
          onload="hideLoadingIndicator()">
          <p>Your browser doesn't support iframes. Please <a href="/api/ripraven/" target="_blank">open RipRaven in a new tab</a>.</p>
        </iframe>
      </div>

      <div class="tips-section">
        <p>üí° <strong>Tips:</strong></p>
        <ul>
          <li>Paste RavenScans or manga.pics URLs to download comics</li>
          <li>Use keyboard shortcuts: ‚Üë‚Üì or j/k to scroll, spacebar for page down</li>
          <li>All downloads are saved locally and can be read offline</li>
        </ul>
      </div>
    </main>
    <script>
      function hideLoadingIndicator() {
        const loadingElement = document.getElementById('iframeLoading');
        if (loadingElement) {
          loadingElement.style.display = 'none';
        }
      }

      // Show loading indicator on iframe error
      document.getElementById('ripravenIframe').addEventListener('error', function() {
        const loadingElement = document.getElementById('iframeLoading');
        if (loadingElement) {
          loadingElement.innerHTML = '‚ö†Ô∏è Failed to load RipRaven. <a href="/api/ripraven/" target="_blank" style="color: #58a6ff;">Open in new tab</a>';
        }
      });

      // Timeout fallback for slow loading
      setTimeout(function() {
        const loadingElement = document.getElementById('iframeLoading');
        if (loadingElement && loadingElement.style.display !== 'none') {
          loadingElement.innerHTML = '‚è±Ô∏è Taking longer than expected... <a href="/api/ripraven/" target="_blank" style="color: #58a6ff;">Open in new tab</a>';
        }
      }, 10000); // 10 second timeout
    </script>
  </body>
</html>